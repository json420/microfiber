#!/usr/bin/make -f

PYTHON3=$(shell py3versions -vr)

%:
	dh $@ --with=python3 --with=python2

test-python%:
	python$* setup.py test -vv
	python2.7 setup.py test -vv

override_dh_auto_install:
	for pyvers in $(shell py3versions -vr); do \
		python$$pyvers setup.py install \
				--install-layout=deb \
				--root $(CURDIR)/debian/python3-microfiber; \
	done
	for pyvers in $(shell pyversions -vr); do \
		python$$pyvers setup.py install \
				--install-layout=deb \
				--root $(CURDIR)/debian/python-microfiber; \
	done

override_dh_auto_test: $(PYTHON3:%=test-python%)
